<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="Description" content="Documentation for Ethel">
    <title>Ethel Docs</title>
    <base href="/">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="assets/styles.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/default.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  </head>
  <body class="app">
    <section class="header">
      <div class="name">
        <a href="">Ethel Docs</a>
      </div>
    </section>
    <aside class="panel menu">
      <div class="docs-menu">
        
          <p class="menu-label">Basics</p>
          <ul class="menu-list">
              <li>
                <a href="">Overview</a>
                
              </li>
              <li>
                <a href="pages/basic/jobs/">Jobs and runs</a>
                
              </li>
              <li>
                <a href="pages/basic/notifications/">Notifications</a>
                
              </li>
              <li>
                <a href="pages/basic/client/">Client</a>
                
              </li>
              <li>
                <a href="pages/basic/deployment/">Deployment</a>
                
              </li>
              <li>
                <a href="pages/basic/core-config/">Core configuration</a>
                
              </li>
          </ul>
          <p class="menu-label">Runner config</p>
          <ul class="menu-list">
              <li>
                <a href="pages/runner-config/common-options/">Common options</a>
                
              </li>
              <li>
                <a href="pages/runner-config/runners/">Runner types</a>
                
              </li>
              <li>
                <a href="pages/runner-config/mock/">Mock runners</a>
                
              </li>
              <li>
                <a href="pages/runner-config/text-files/">Text files</a>
                
              </li>
              <li>
                <a href="pages/runner-config/file-system/">File system</a>
                
              </li>
              <li>
                <a href="pages/runner-config/databases/">Databases</a>
                
              </li>
              <li>
                <a href="pages/runner-config/email/">Email</a>
                
              </li>
              <li>
                <a href="pages/runner-config/ot/">OpenText runners</a>
                
                  <ul>
                      <li>
                        <a href="pages/runner-config/archive-center/">Archive Server</a>
                      </li>
                      <li>
                        <a href="pages/runner-config/content-server/">Content Server</a>
                      </li>
                      <li>
                        <a href="pages/runner-config/success-factors/">Success Factors</a>
                      </li>
                  </ul>
                
              </li>
              <li>
                <a href="pages/runner-config/microsoft/">Microsoft runners</a>
                
                  <ul>
                      <li>
                        <a href="pages/runner-config/sharepoint/">SharePoint</a>
                      </li>
                  </ul>
                
              </li>
          </ul>
          <p class="menu-label">Development</p>
          <ul class="menu-list">
              <li>
                <a href="pages/development/design/">Design</a>
                
              </li>
              <li>
                <a href="pages/development/repository/">Repository</a>
                
              </li>
              <li>
                <a href="pages/development/server/">Server</a>
                
              </li>
              <li>
                <a href="pages/development/runners/">Runners</a>
                
              </li>
          </ul>
      </div>
    </aside>
    <section class="panel">
      <div class="section">
        <div class="container is-fluid">
          
<h3 class="title is-3">SharePoint runners</h3>
<div class="content">

  <p>These runners are related to working with Microsoft SharePoint.</p>
  <p>The runners documented here are:</p>
  <ul>
    <li><a href="pages/runner-config/sharepoint/#sp-extractor">SPListItemExtractor</a></li>
    <li><a href="pages/runner-config/sharepoint/#sp-staging">SharePointStaging</a></li>
    <li><a href="pages/runner-config/sharepoint/#sp-loader">SPListItemLoader</a></li>
    <li><a href="pages/runner-config/sharepoint/#fs-sp">FSToSPTransformer</a></li>
    <li><a href="pages/runner-config/sharepoint/#otcs-sp">OTCSToSPTransformer</a></li>
    <li><a href="pages/runner-config/sharepoint/#sp-sp">SPToSPTransformer</a></li>
  </ul>
  <p>Other related runners:</p>
  <ul>
    <li><a href="pages/runner-config/file-system/#sp-to-fs">SPToFSTransformer</a></li>
    <li><a href="pages/runner-config/content-server/#sp-to-otcs">SPToOTCSTransformer</a></li>
  </ul>

  <p>All of these runners have been used in production, but most have been rewritten to provide better support
    for migrating metadata and other elements so the status has been reset to developed</p>

  <section class="SPConnection">

    <h4 id="sp-connection" class="title is-4 docs-subhead">SharePoint connection</h4>
    <p>The connection object for all SharePoint runners changes depending on the SharePoint version and the organisation
      hosting the server. Look at the examples below for different configuration combinations.</p>


    <table class="table is-fullwidth">
      <thead>
        <th>Attribute</th>
        <th>Data type</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>spHost</td>
          <td>string</td>
          <td>The SharePoint host name.</td>
        </tr>
        <tr>
          <td>clientId</td>
          <td>string</td>
          <td>The ID for the Entra client configuration.</td>
        </tr>
        <tr>
          <td>clientCertificate.thumbprint</td>
          <td>string</td>
          <td>The thumbprint used to idenitify the certificate.</td>
        </tr>
        <tr>
          <td>certPath</td>
          <td>string</td>
          <td>The path to the certificate file.</td>
        </tr>
        <tr>
          <td>tenantId</td>
          <td>string</td>
          <td>The tenant ID for the host connection.</td>
        </tr>
        <tr>
          <td>username</td>
          <td>string</td>
          <td>The username for an NTLM connection.</td>
        </tr>
        <tr>
          <td>password</td>
          <td>string</td>
          <td>The password for an NTLM connection.</td>
        </tr>
        <tr>
          <td>useNTLM</td>
          <td>boolean</td>
          <td>Whether to attempt an NTLM connection. Defaults to <code>false</code>.</td>
        </tr>
      </tbody>
    </table>
    <hr>

    <p>Example SharePoint online connection object:</p>
    <pre class="code">{
  "clientId": "5c2d4774-bc67-4e1d-b9c1-3b56e82c1b1f",
  "clientCertificate": {
    "thumbprint": "A33177147C1CB4D1D1A63CAF8B5A9E38CA36DAE8",
  },
  "certPath": "D:\\certs\\ethel-piggles.sharepoint.com.pk.txt",
  "spHost": "https://nerks.sharepoint.com",
  "tenantId": "83fc94bd-cff5-40f5-91ef-04bc08b68f32",
}
</pre>

    <p>Example NTLM connection object:</p>
    <pre class="code">{
  "username": "NERKS/fred.nerk",
  "password": "nerk",
  "spHost": "https://nerks.sharepoint.com",
  "useNTLM": true
}</pre>

  </section>

  <section class="SPListItemExtractor">

    <h4 id="sp-extractor" class="title is-4 docs-subhead">SPListItemExtractor</h4>
    <p><a href="pages/runner-config/runner-status/"><span class="tag is-link">Production</span></a></p>

    <p>This runner will extract information from SharePoint. It will not extract any files from SharePoint. To
      extract files from SharePoint to upload to other systems use the SharePointStaging runner.</p>

    <h5 class="title is-5">Configuration options</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Default</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>addSummary</td>
          <td>boolean</td>
          <td><code>false</code></td>
          <td>Whether to add a summary for each extractRoot, adds load so only use when needed</td>
        </tr>
        <tr>
          <td>batchConfig</td>
          <td>number | BatchConfig, <strong>mandatory</strong></td>
          <td>none</td>
          <td>See <a href="pages/runner-config/common-options/#batches">batches</a></td>
        </tr>
        <tr>
          <td>cancelCheckNumber</td>
          <td>number</td>
          <td><code>50</code></td>
          <td>How often, in tasks raised, to check if the extract should be cancelled</td>
        </tr>
        <tr>
          <td>connection</td>
          <td>LookupDetails, <strong>mandatory</strong></td>
          <td>none</td>
          <td>The name and key to the lookup with the <a href="pages/runner-config/sharepoint/#sp-connection">SharePoint
              connection</a> details.</td>
        </tr>
        <tr>
          <td>extractRoot</td>
          <td>(string | SPExtractRoot)[], <strong>mandatory</strong></td>
          <td>none</td>
          <td>If exporting the full list to another system you can use the list URL, otherwise use the SPExtractRoot
            object</td>
        </tr>
        <tr>
          <td>hashName</td>
          <td>string, <strong>mandatory</strong></td>
          <td>none</td>
          <td>The lookup name used to store the extract hash</td>
        </tr>
        <tr>
          <td>ignore</td>
          <td>any</td>
          <td>none</td>
          <td>See <a href="pages/runner-config/common-options/#ignore">ignore items</a>. This runner only supports file
            system based ignore options</td>
        </tr>
        <tr>
          <td>quarantinedLookupName</td>
          <td>string</td>
          <td><code>quarantinedSPListItemExtractor</code></td>
          <td>Name value for the quarantine lookup</td>
        </tr>
      </tbody>
    </table>
    <hr>

    <h5 class="title is-5">Message attributes</h5>

    <p>It populates the following attributes in the new tasks it creates:</p>
    <ul>
      <li><code>item</code> metadata for the item extracted</li>
      <li><code>quarantine</code> quarantine lookup for the item</li>
    </ul>
    <hr>

  </section>

  <section class="SharePointStaging">

    <h4 id="sp-staging" class="title is-4 docs-subhead">SharePointStaging</h4>
    <p><a href="pages/runner-config/runner-status/"><span class="tag is-link">Developed</span></a></p>

    <p>This runner will copy files from SharePoint to the specified storage location</p>

    <h5 class="title is-5">Configuration options</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Default</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>allVersions</td>
          <td>boolean</td>
          <td><code>false</code></td>
          <td>Whether to extract the latest version or all versions</td>
        </tr>
        <tr>
          <td>connection</td>
          <td>LookupDetails, <strong>mandatory</strong></td>
          <td>none</td>
          <td>The name and key to the lookup with the <a href="pages/runner-config/sharepoint/#sp-connection">SharePoint
              connection</a> details.</td>
        </tr>
        <tr>
          <td>extractItem</td>
          <td>string</td>
          <td><code>extractItem</code></td>
          <td>The message attribute containing the extracted item</td>
        </tr>
        <tr>
          <td>extractRoot</td>
          <td>string</td>
          <td><code>extractRoot</code></td>
          <td>The message attribute with the configuration used for the extract item</td>
        </tr>
        <tr>
          <td>stagingProvider</td>
          <td>any, <strong>mandatory</strong></td>
          <td>none</td>
          <td>The configuration details for the storage provider</td>
        </tr>
      </tbody>
    </table>

    <h5 class="title is-5">Message attributes</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractItem</td>
          <td>SPListItem, <strong>mandatory</strong></td>
          <td>The object extracted from the SharePoint API</td>
        </tr>
        <tr>
          <td>extractRoot</td>
          <td>SPExtractRoot, <strong>mandatory</strong></td>
          <td>The configuration used for the extract item</td>
        </tr>
      </tbody>
    </table>
    <p>Message attribute names can be changed in the configuration options.</p>

    <p>It populates the following attributes in the new tasks it creates:</p>
    <ul>
      <li><code>sourceFile</code> metadata for the item extracted</li>
    </ul>
    <hr>

  </section>

  <section class="SPListItemLoader">

    <p id="sp-loader" class="title is-4 docs-subhead">SPListItemLoader</p>
    <p><a href="pages/runner-config/runner-status/"><span class="tag is-link">Developed</span></a></p>

    <p>This runner will create the SharePoint item using the loadItem message attribute</p>

    <h5 class="title is-5">Configuration options</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Default</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>addFields</td>
          <td>boolean</td>
          <td><code>false</code></td>
          <td>Whether to add fields to the list if they are missing</td>
        </tr>
        <tr>
          <td>addFullItem</td>
          <td>boolean</td>
          <td><code>false</code></td>
          <td>Whether the loadedItem is the ServerRelativeURL or the full object</td>
        </tr>
        <tr>
          <td>addHash</td>
          <td>boolean</td>
          <td><code>true</code></td>
          <td>Whether to add the extractHash lookup</td>
        </tr>
        <tr>
          <td>connection</td>
          <td>LookupDetails, <strong>mandatory</strong></td>
          <td>none</td>
          <td>The name and key to the lookup with the <a href="pages/runner-config/sharepoint/#sp-connection">SharePoint
              connection</a> details.</td>
        </tr>
        <tr>
          <td>handleExisting</td>
          <td>string</td>
          <td>error</td>
          <td>This runner supports three options:
            <ul>
              <li><code>complete</code> - complete the task and add the hash</li>
              <li><code>error</code> - throw an error</li>
              <li><code>overwrite</code> - overwrite the existing file with the newly extracted file</li>
            </ul>
          </td>
        </tr>
        <tr>
          <td>loadItem</td>
          <td>string</td>
          <td>loadItem</td>
          <td>The message attribute that contains the SPLoadItem object</td>
        </tr>
        <tr>
          <td>loadedItemLabel</td>
          <td>string</td>
          <td>OTCSLoadedItem</td>
          <td>The label to use for the loaded item in the message</td>
        </tr>
      </tbody>
    </table>
    <hr>

    <h5 class="title is-5">Message attributes</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractHash</td>
          <td>Lookup</td>
          <td>The extract hash object</td>
        </tr>
        <tr>
          <td>loadItem</td>
          <td>SPLoadItem, <strong>mandatory</strong></td>
          <td>The information used by the loader to create the item.</td>
        </tr>
      </tbody>
    </table>

    <p>Message attribute names can be changed in the configuration options.</p>

    <p>It populates the following attributes in the new tasks it creates:</p>
    <ul>
      <li><code>sourceFile</code> an array of versions that were staged</li>
    </ul>
    <hr>

    <p>The SPLoadItem and SPLoadVersion class definitions:</p>
    <pre class="code">export class SPLoadVersion {
  order: number;
  created?: string;
  modified?: string;
  filename?: string;
  sourceFile: string | StagedFile;

  constructor(values?: any) {
    Object.assign(this, values);
  }
}

export class SPLoadItem {
  skip = false;
  type: 'Folder' | 'File' | 'ListItem';
  name: string;
  title: string;
  listPath: string;
  fields: { [name: string]: any } = {};
  versions?: SPLoadVersion[];

  constructor(values?: any) {
    Object.assign(this, values);
  }
}</pre>
    <hr>

  </section>

  <section class="FSToSPTransformer">

    <p id="fs-sp" class="title is-4 docs-subhead">FSToSPTransformer</p>
    <p><a href="pages/runner-config/runner-status/"><span class="tag is-link">Developed</span></a></p>

    <p>This runner transforms file system extractor messages to the SPLoadItem format</p>

    <h5 class="title is-5">Configuration options</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Default</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractItem</td>
          <td>string</td>
          <td><code>extractItem</code></td>
          <td>The message attribute containing the extracted item</td>
        </tr>
        <tr>
          <td>loadRoot</td>
          <td>string | SPLoadRoot, <strong>mandatory</strong></td>
          <td>none</td>
          <td>Either the target SharePoint list URL or the SPLoadRoot object, if a target subfolder is used</td>
        </tr>
        <tr>
          <td>sourceFile</td>
          <td>string</td>
          <td><code>sourceFile</code></td>
          <td>The message attribute with the extracted file information</td>
        </tr>
      </tbody>
    </table>
    <hr>

    <h5 class="title is-5">Message attributes</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractItem</td>
          <td>FSExtractItem, <strong>mandatory</strong></td>
          <td>The file system object</td>
        </tr>
        <tr>
          <td>sourceFile</td>
          <td>string | SourceFile</td>
          <td>The extracted file information</td>
        </tr>
      </tbody>
    </table>

    <p>Message attribute names can be changed in the configuration options.</p>

    <p>It populates the following attributes in the new tasks it creates:</p>
    <ul>
      <li><code>loadItem</code> an array of versions that were staged</li>
    </ul>
    <hr>

  </section>

  <section class="OTCSToSPTransformer">

    <p id="otcs-sp" class="title is-4 docs-subhead">OTCSToSPTransformer</p>
    <p><a href="pages/runner-config/runner-status/"><span class="tag is-link">Developed</span></a></p>

    <p>This runner transforms OTCS extractor messages to the SPLoadItem format</p>

    <h5 class="title is-5">Configuration options</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Default</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractItem</td>
          <td>string</td>
          <td><code>extractItem</code></td>
          <td>The message attribute containing the extracted item</td>
        </tr>
        <tr>
          <td>metadataMapping</td>
          <td>{ [csAttId: string]: string }</td>
          <td>none</td>
          <td>key-value pairs with CS attribute id as the key and the SP field title as the value</td>
        </tr>
        <tr>
          <td>sourceFile</td>
          <td>string</td>
          <td><code>sourceFile</code></td>
          <td>The message attribute with the extracted file information</td>
        </tr>
        <tr>
          <td>targetList</td>
          <td>string | SPList, <strong>mandatory</strong></td>
          <td>none</td>
          <td>Either the target SharePoint list URL or the SPList object, if a target subfolder is used</td>
        </tr>
      </tbody>
    </table>
    <hr>

    <h5 class="title is-5">Message attributes</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractItem</td>
          <td>CSNode, <strong>mandatory</strong></td>
          <td>The Content Server object</td>
        </tr>
        <tr>
          <td>sourceFile</td>
          <td>SourceFile[]</td>
          <td>The extracted file information</td>
        </tr>
      </tbody>
    </table>

    <p>Message attribute names can be changed in the configuration options.</p>

    <p>It populates the following attributes in the new tasks it creates:</p>
    <ul>
      <li><code>loadItem</code> an array of versions that were staged</li>
    </ul>
    <hr>

  </section>

  <section class="SPToSPTransformer">

    <p id="sp-sp" class="title is-4 docs-subhead">SPToSPTransformer</p>
    <p><a href="pages/runner-config/runner-status/"><span class="tag is-link">Developed</span></a></p>

    <p>This runner transforms SharePoint extract items to the SPLoadItem format</p>

    <h5 class="title is-5">Configuration options</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Default</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractFields</td>
          <td>string</td>
          <td><code>extractFields</code></td>
          <td>The message attribute containing the extracted field definitions</td>
        </tr>
        <tr>
          <td>extractItem</td>
          <td>string</td>
          <td><code>extractItem</code></td>
          <td>The message attribute containing the extracted item</td>
        </tr>
        <tr>
          <td>extractRoot</td>
          <td>string</td>
          <td><code>extractRoot</code></td>
          <td>The message attribute with the initial extractor config</td>
        </tr>
        <tr>
          <td>extractValues</td>
          <td>string</td>
          <td><code>extractValues</code></td>
          <td>The message attribute containing the extracted field values</td>
        </tr>
        <tr>
          <td>handleMetadataError</td>
          <td>string</td>
          <td><code>error</code></td>
          <td>Whether to throw an error or log a warning if there is an error in mapping the metadata. Use
            <code>warning</code> to log the error
          </td>
        </tr>
        <tr>
          <td>loadRoot</td>
          <td>SPLoadRoot</td>
          <td>none</td>
          <td>Only required if load details are not in the extract config, either the target SharePoint list URL or the
            SPLoadRoot object, if a target subfolder is used</td>
        </tr>
        <tr>
          <td>sourceFile</td>
          <td>string</td>
          <td><code>sourceFile</code></td>
          <td>The message attribute with the extracted file information</td>
        </tr>
      </tbody>
    </table>
    <hr>

    <h5 class="title is-5">Message attributes</h5>

    <table class="table is-fullwidth">
      <thead>
        <th>Option</th>
        <th>Data type</th>
        <th>Description</th>
      </thead>
      <tbody>
        <tr>
          <td>extractFields</td>
          <td>SPField[]</td>
          <td>The extracted SharePoint field definitions</td>
        </tr>
        <tr>
          <td>extractItem</td>
          <td>SPListItem, <strong>mandatory</strong></td>
          <td>The SharePoint list item object</td>
        </tr>
        <tr>
          <td>extractRoot</td>
          <td>SPExtractRoot, <strong>mandatory</strong></td>
          <td>The configuration used for the extract item</td>
        </tr>
        <tr>
          <td>extractValues</td>
          <td>{ [EntityPropertyName: string]: any }</td>
          <td>The extracted SharePoint field values</td>
        </tr>
        <tr>
          <td>sourceFile</td>
          <td>SourceFile[]</td>
          <td>The extracted file information</td>
        </tr>
      </tbody>
    </table>

    <p>Message attribute names can be changed in the configuration options.</p>

    <p>It populates the following attributes in the new tasks it creates:</p>
    <ul>
      <li><code>loadItem</code> the SharePoint item to be created</li>
    </ul>
    <hr>

  </section>

</div>
        </div>
        <div class="container is-fluid dl-footer">
          <a href="https://driverlane.com.au">Driver Lane</a>
          &copy; 2020-2025
        </div>
      </div>
    </div>
  </body>
</html>